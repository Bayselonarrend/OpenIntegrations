
Функция ПрочитатьФайлJSON(Знач Путь) Экспорт
	
	ЧтениеJSON = Новый ЧтениеJSON();
	ЧтениеJSON.ОткрытьФайл(Путь);
	Данные = ПрочитатьJSON(ЧтениеJSON, Истина);
	ЧтениеJSON.Закрыть();
	
	Возврат Данные;
	
КонецФункции

Процедура ЗаписатьФайлJSON(Знач Путь, Знач Данные) Экспорт
	
	Запись = Новый ЗаписьJSON;
	ПараметрыЗаписиJSON = Новый ПараметрыЗаписиJSON(ПереносСтрокJSON.Авто);
	Запись.ОткрытьФайл(Путь, , , ПараметрыЗаписиJSON);
	ЗаписатьJSON(Запись, Данные);
	Запись.Закрыть();
	
КонецПроцедуры

Функция JsonВСоответствие(Знач Текст) Экспорт

    ЧтениеJSON = Новый ЧтениеJSON;
    ТипТекста  = ТипЗнч(Текст);

    Если ТипТекста = Тип("ДвоичныеДанные") Тогда

        Текст = ПолучитьСтрокуИзДвоичныхДанных(Текст);
        ЧтениеJSON.УстановитьСтроку(Текст);

    ИначеЕсли ТипТекста = Тип("Поток") Или ТипТекста = Тип("ПотокВПамяти") Или ТипТекста = Тип("ФайловыйПоток") Тогда


		ЧтениеДанных    = Новый ЧтениеДанных(Текст);
		РезультатЧтения = ЧтениеДанных.Прочитать();
		JSONДвоичные    = РезультатЧтения.ПолучитьДвоичныеДанные();

		ЧтениеJSON.УстановитьСтроку(ПолучитьСтрокуИзДвоичныхДанных(JSONДвоичные));
		ЧтениеДанных.Закрыть();

    Иначе

        ЧтениеJSON.УстановитьСтроку(Строка(Текст));

    КонецЕсли;

    Данные = ПрочитатьJSON(ЧтениеJSON, Истина, Неопределено, ФорматДатыJSON.ISO);
    ЧтениеJSON.Закрыть();

    Возврат Данные;

КонецФункции

Процедура СообщитьПроцесс(Знач Текст) экспорт
	Сообщить(СтрШаблон("[%1] %2", ТекущаяДата(), Текст));
КонецПроцедуры

Функция ЗапуститьВнешнееПриложение(Знач СтрокаВызова, Знач Каталог = Неопределено, Знач ВыводВКонсоль = Истина) Экспорт
	
	КодВозврата = Неопределено;
	
	Процесс = СоздатьПроцесс(СтрокаВызова, Каталог, Истина);
	Процесс.Запустить();
	
	ПериодОпросаВМиллисекундах = 10;
	МассивРезультата = Новый Массив;

	Пока Не Процесс.Завершен Или Процесс.ПотокВывода.ЕстьДанные Или Процесс.ПотокОшибок.ЕстьДанные Цикл

		Приостановить(ПериодОпросаВМиллисекундах);

		ОчереднаяСтрокаВывода = Процесс.ПотокВывода.Прочитать();
		ОчереднаяСтрокаОшибок = Процесс.ПотокОшибок.Прочитать();

		Если Не ПустаяСтрока(ОчереднаяСтрокаВывода) Тогда

			Если ВыводВКонсоль Тогда
				Сообщить(ОчереднаяСтрокаВывода, СтатусСообщения.Информация);
			КонецЕсли;

			МассивРезультата.Добавить(ОчереднаяСтрокаВывода);

		КонецЕсли;

		Если Не ПустаяСтрока(ОчереднаяСтрокаОшибок) Тогда
			Сообщить(ОчереднаяСтрокаОшибок, СтатусСообщения.Важное);
		КонецЕсли;

	КонецЦикла;

	
	Если Процесс.КодВозврата <> 0 Тогда
		ВызватьИсключение "Process failed";
	КонецЕсли;

	Возврат СтрСоединить(МассивРезультата, Символы.ПС);
	
КонецФункции

Функция ПолучитьАлфавит() Экспорт
	
	Алфавит = Новый Массив;
	
	Алфавит.Добавить("а");
	Алфавит.Добавить("б");
	Алфавит.Добавить("в");
	Алфавит.Добавить("г");
	Алфавит.Добавить("д");
	Алфавит.Добавить("е");
	Алфавит.Добавить("ё");
	Алфавит.Добавить("ж");
	Алфавит.Добавить("з");
	Алфавит.Добавить("и");
	Алфавит.Добавить("й");
	Алфавит.Добавить("к");
	Алфавит.Добавить("л");
	Алфавит.Добавить("м");
	Алфавит.Добавить("н");
	Алфавит.Добавить("о");
	Алфавит.Добавить("п");
	Алфавит.Добавить("р");
	Алфавит.Добавить("с");
	Алфавит.Добавить("т");
	Алфавит.Добавить("у");
	Алфавит.Добавить("ф");
	Алфавит.Добавить("х");
	Алфавит.Добавить("ц");
	Алфавит.Добавить("ч");
	Алфавит.Добавить("ш");
	Алфавит.Добавить("щ");
	Алфавит.Добавить("ъ");
	Алфавит.Добавить("ы");
	Алфавит.Добавить("ь");
	Алфавит.Добавить("э");
	Алфавит.Добавить("ю");
	Алфавит.Добавить("я");
	
	Возврат Алфавит;
	
КонецФункции

Функция ПолучитьМассивСимволов() Экспорт
	
	МассивСимволов = Новый Массив();
	МассивСимволов.Добавить(";");
	МассивСимволов.Добавить(".");
	МассивСимволов.Добавить(",");
	МассивСимволов.Добавить(")");
	МассивСимволов.Добавить("(");
	МассивСимволов.Добавить("/");
	МассивСимволов.Добавить("\");
	МассивСимволов.Добавить("[");
	МассивСимволов.Добавить("]");
	МассивСимволов.Добавить("=");
	МассивСимволов.Добавить("+");
	МассивСимволов.Добавить("-");
	МассивСимволов.Добавить("*");
	МассивСимволов.Добавить("#");
	МассивСимволов.Добавить(" ");
	МассивСимволов.Добавить("_");
	МассивСимволов.Добавить("""");
	
	Возврат МассивСимволов;
	
КонецФункции