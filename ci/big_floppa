pipeline {
	agent {
		label 'windows'
	}

    stages {
        stage('OpenIntegrations - Build') {
            steps {
                build job: 'OpiMain', wait: true
            }
        }

        stage('OpenIntegrations - 1C DB Update') {
            steps {
                build job: 'OpiBaseUpdate', wait: true
            }
        }

        stage('Melezh - Main + Release') {
            steps {
                build job: 'MelezhRelease', wait: true
            }
        }

        stage('OpenIntegrations - Release') {
            steps {
                echo 'Release (OpenIntegrations)'
                build job: 'OpiRelease', wait: true
            }
        }
        stage('OpenIntegrations - Test (1C, Win, RU)') {
            steps {
                script {
                    try {
                        build job: 'Opi1cWinRu', propagate: false, wait: true
                    } catch (Exception e) {
                        echo "Stage failed, but continuing: ${e.message}"
                    }
                }
            }
        }
        stage('OpenIntegrations - Test (1C, Win, EN)') {
            steps {
                script {
                    try {
                        build job: 'Opi1cWinEn', propagate: false, wait: true
                    } catch (Exception e) {
                        echo "Stage failed, but continuing: ${e.message}"
                    }
                }
            }
        }
    }
}