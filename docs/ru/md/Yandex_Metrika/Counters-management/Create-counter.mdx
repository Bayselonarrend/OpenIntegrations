---
sidebar_position: 1
description: Создать счетчик и другие функции для работы с Yandex Metrika в Открытом пакете интеграций - бесплатной open-source библиотеке интеграций для 1С:Предприятие 8, OneScript и CLI
keywords: [1C, 1С, 1С:Предприятие, 1С:Предприятие 8.3, API, Интеграция, Сервисы, Обмен, OneScript, CLI, Yandex Metrika]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Создать счетчик
 Создает счетчик по описанию полей



`Функция СоздатьСчетчик(Знач Токен, Знач СтруктураСчетчика) Экспорт`

  | Параметр | CLI опция | Тип | Обяз. | Назначение |
  |-|-|-|-|-|
  | Токен | --token | Строка | &#x2714; | Токен авторизации |
  | СтруктураСчетчика | --fields | Структура Из КлючИЗначение | &#x2714; | Структура счетчика. См. ПолучитьСтруктуруСчетчика |

  
  Возвращаемое значение:   Соответствие Из КлючИЗначение - сериализованный JSON ответа от Yandex

<br/>

:::tip
Метод в документации API: [Создание счетчика](https://yandex.ru/dev/metrika/ru/management/openapi/counter/addCounter)
:::
<br/>



```bsl title="Пример использования для 1С:Предприятие/OneScript"
    Токен = "y0_AgAAAABdylaOAAy9KgAAAAEXh6i...";

    СтруктураСчетчика = Новый Структура;
    СтруктураСчетчика.Вставить("autogoals_enabled", Истина);

    СтруктураНастроекКода = Новый Структура;
    СтруктураНастроекКода.Вставить("async"          , 0);
    СтруктураНастроекКода.Вставить("clickmap"       , 1);
    СтруктураНастроекКода.Вставить("ecommerce"      , 1);
    СтруктураНастроекКода.Вставить("in_one_line"    , 0);
    СтруктураНастроекКода.Вставить("track_hash"     , 1);
    СтруктураНастроекКода.Вставить("visor"          , 1);
    СтруктураНастроекКода.Вставить("xml_site"       , 0);
    СтруктураНастроекКода.Вставить("ytm"            , 0);
    СтруктураНастроекКода.Вставить("alternative_cdn", 1);

    СтруктураИнформера = Новый Структура;
    СтруктураИнформера.Вставить("color_arrow", 1);
    СтруктураИнформера.Вставить("color_end"  , "EFEFEFFE");
    СтруктураИнформера.Вставить("color_start", "EEEEEEEE");
    СтруктураИнформера.Вставить("color_text" , 0);
    СтруктураИнформера.Вставить("enabled"    , 1);
    СтруктураИнформера.Вставить("indicator"  , "uniques");
    СтруктураИнформера.Вставить("size"       , 2);
    СтруктураИнформера.Вставить("type"       , "ext");

    СтруктураНастроекКода.Вставить("informer", СтруктураИнформера);

    СтруктураСчетчика.Вставить("code_options", СтруктураНастроекКода);

    СтруктураФлагов = Новый Структура;
    СтруктураФлагов.Вставить("collect_first_party_data"             , Истина);
    СтруктураФлагов.Вставить("measurement_enabled"                  , Истина);
    СтруктураФлагов.Вставить("use_in_benchmarks"                    , Истина);
    СтруктураФлагов.Вставить("direct_allow_use_goals_without_access", Истина);

    СтруктураСчетчика.Вставить("counter_flags"          , СтруктураФлагов);
    СтруктураСчетчика.Вставить("favorite"               , 1);
    СтруктураСчетчика.Вставить("filter_robots"          , 2);
    СтруктураСчетчика.Вставить("gdpr_agreement_accepted", 1);

    СтруктураДомена = Новый Структура("site", "openintegrations.dev");

    СтруктураСчетчика.Вставить("site2", СтруктураДомена);

    Результат = OPI_YandexMetrika.СоздатьСчетчик(Токен, СтруктураСчетчика);
```
    

 <Tabs>
  
    <TabItem value="bash" label="Bash" default>
        ```bash
            # JSON данные также могут быть переданы как путь к файлу .json
            
            oint metrika СоздатьСчетчик \
              --token "***" \
              --fields "{'autogoals_enabled':'True','code_options':{'async':'0','clickmap':'1','ecommerce':'1','in_one_line':'0','track_hash':'1','visor':'1','xml_site':'0','ytm':'0','alternative_cdn':'1','informer':{'color_arrow':'1','color_end':'EFEFEFFE','color_start':'EEEEEEEE','color_text':'0','enabled':'1','indicator':'uniques','size':'2','type':'ext'}},'counter_flags':{'collect_first_party_data':'True','measurement_enabled':'True','use_in_benchmarks':'True','direct_allow_use_goals_without_access':'True'},'favorite':'1','filter_robots':'2','gdpr_agreement_accepted':'1','site2':{'site':'openintegrations.dev'}}"
        ```
    </TabItem>
  
    <TabItem value="bat" label="CMD/Bat" default>
        ```batch
            :: JSON данные также могут быть переданы как путь к файлу .json
            
            oint metrika СоздатьСчетчик ^
              --token "***" ^
              --fields "{'autogoals_enabled':'True','code_options':{'async':'0','clickmap':'1','ecommerce':'1','in_one_line':'0','track_hash':'1','visor':'1','xml_site':'0','ytm':'0','alternative_cdn':'1','informer':{'color_arrow':'1','color_end':'EFEFEFFE','color_start':'EEEEEEEE','color_text':'0','enabled':'1','indicator':'uniques','size':'2','type':'ext'}},'counter_flags':{'collect_first_party_data':'True','measurement_enabled':'True','use_in_benchmarks':'True','direct_allow_use_goals_without_access':'True'},'favorite':'1','filter_robots':'2','gdpr_agreement_accepted':'1','site2':{'site':'openintegrations.dev'}}"
        ```
    </TabItem>
</Tabs>


```json title="Результат"
Соответствие
```
