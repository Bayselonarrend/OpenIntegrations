---
sidebar_position: 3
description: Получить пользователей и другие функции для работы с MongoDB в Открытом пакете интеграций - бесплатной open-source библиотеке интеграций для 1С:Предприятие 8, OneScript и CLI
keywords: [1C, 1С, 1С:Предприятие, 1С:Предприятие 8.3, API, Интеграция, Сервисы, Обмен, OneScript, CLI, MongoDB]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Получить пользователей
 Получает данные одного или нескольких пользователей



`Функция ПолучитьПользователей(Знач Соединение, Знач Пользователи, Знач База = Неопределено, Знач ПолучатьПароль = Ложь, Знач ПолучатьПривилегии = Ложь) Экспорт`

  | Параметр | CLI опция | Тип | Обяз. | Назначение |
  |-|-|-|-|-|
  | Соединение | --dbc | Строка, Произвольный | &#x2714; | Соединение или строка подключения |
  | Пользователи | --usrs | Произвольный | &#x2714; | Имя пользователя, структура или массив структур пользователей |
  | База | --db | Строка | &#x2716; | Имя базы. Текущая база, если не указано |
  | ПолучатьПароль | --spwd | Булево | &#x2716; | Добавляет хеш пароля пользователя в возвращаемые данные |
  | ПолучатьПривилегии | --sprv | Булево | &#x2716; | Добавляет список привилегий пользователя в возвращаемые данные |

  
  Возвращаемое значение:   Соответствие Из КлючИЗначение - Результат выполнения операции

:::tip
Пользователь может быть указан в одном из следующих форматов:<br/>Строка:    `имя пользователя`<br/>Структура: `{ user: &lt;имя&gt;, db: &lt;база данных&gt; }`<br/>Массив:    `[ { user: &lt;имя&gt;, db: &lt;база данных&gt; },  { user: &lt;имя&gt;, db: &lt;база данных&gt; }, ... ]`
:::
<br/>


```bsl title="Пример использования для 1С:Предприятие/OneScript"
    Адрес  = "127.0.0.1:1234";
    Логин  = "bayselonarrend";
    Пароль = "12we...";
    База   = "main";

    ПараметрыПодключения = Новый Структура("authSource", "admin");
    Опции                = Новый Структура;
    Опции.Вставить("addr"  , Адрес);
    Опции.Вставить("usr"   , Логин);
    Опции.Вставить("pwd"   , Пароль);
    Опции.Вставить("params", ПараметрыПодключения);

    СтрокаПодключения = OPI_ПолучениеДанныхТестов.ВыполнитьТестCLI("mongodb", "СформироватьСтрокуПодключения", Опции);
    Соединение        = OPI_MongoDB.ОткрытьСоединение(СтрокаПодключения);

    ИмяПользователя = "newuser";

    Опции = Новый Структура;
    Опции.Вставить("dbc" , Соединение);
    Опции.Вставить("usrs", ИмяПользователя);
    Опции.Вставить("db"  , База);

    Результат = OPI_ПолучениеДанныхТестов.ВыполнитьТестCLI("mongodb", "ПолучитьПользователей", Опции);

    МассивПользователей = Новый Массив;
    МассивПользователей.Добавить(Новый Структура("user,db", "bayselonarrend", "admin"));
    МассивПользователей.Добавить(Новый Структура("user,db", "newuser"       , "main"));

    Опции = Новый Структура;
    Опции.Вставить("dbc" , Соединение);
    Опции.Вставить("usrs", МассивПользователей);
    Опции.Вставить("db"  , База);
    Опции.Вставить("spwd", Истина);
    Опции.Вставить("sprv", Истина);

    Результат = OPI_ПолучениеДанныхТестов.ВыполнитьТестCLI("mongodb", "ПолучитьПользователей", Опции);
```
    

 <Tabs>
  
    <TabItem value="bash" label="Bash" default>
        ```bash
            # JSON данные также могут быть переданы как путь к файлу .json
            
            oint mongodb ПолучитьПользователей \
              --dbc "mongodb://bayselonarrend:12we3456!2154@127.0.0.1:27017/?authSource=admin" \
              --usrs "[{'user':'bayselonarrend','db':'admin'},{'user':'newuser','db':'main'}]" \
              --db "main" \
              --spwd true \
              --sprv true
        ```
    </TabItem>
  
    <TabItem value="bat" label="CMD/Bat" default>
        ```batch
            :: JSON данные также могут быть переданы как путь к файлу .json
            
            oint mongodb ПолучитьПользователей ^
              --dbc "mongodb://bayselonarrend:12we3456!2154@127.0.0.1:27017/?authSource=admin" ^
              --usrs "[{'user':'bayselonarrend','db':'admin'},{'user':'newuser','db':'main'}]" ^
              --db "main" ^
              --spwd true ^
              --sprv true
        ```
    </TabItem>
</Tabs>


```json title="Результат"
{
 "result": true,
 "data": {
  "users": [
   {
    "_id": "admin.bayselonarrend",
    "userId": {
     "__B64_BINARY__": "o/sTQLP2Q0Gh/ktdyTzYEw=="
    },
    "user": "bayselonarrend",
    "db": "admin",
    "mechanisms": [
     "SCRAM-SHA-1",
     "SCRAM-SHA-256"
    ],
    "credentials": {
     "SCRAM-SHA-1": {
      "iterationCount": 10000,
      "salt": "uJIHxzZApTwt+kxKvyGNFQ==",
      "storedKey": "***",
      "serverKey": "***"
     },
     "SCRAM-SHA-256": {
      "iterationCount": 15000,
      "salt": "5AWQEtOv0LtrbiyyPowpiiixAz+yuDiU5ckYMQ==",
      "storedKey": "***",
      "serverKey": "***"
     }
    },
    "roles": [
     {
      "role": "root",
      "db": "admin"
     }
    ],
    "inheritedRoles": [
     {
      "role": "root",
      "db": "admin"
     }
    ],
    "inheritedPrivileges": [
     {
      "resource": {
       "cluster": true
      },
      "actions": [
       "addShard",
       "allCollectionStats",
       "appendOplogNote",
       "applicationMessage",
       "auditConfigure",
       "authSchemaUpgrade",
       "bypassWriteBlockingMode",
       "cleanupOrphaned",
       "connPoolStats",
       "connPoolSync",
       "dropConnections",
       "flushRouterConfig",
       "forceUUID",
       "fsync",
       "getClusterParameter",
       "getDefaultRWConcern",
       "getCmdLineOpts",
       "getLog",
       "getParameter",
       "getShardMap",
       "hostInfo",
       "inprog",
       "invalidateUserCache",
       "killAnyCursor",
       "killAnySession",
       "killop",
       "listDatabases",
       "listSessions",
       "listShards",
       "logRotate",
       "netstat",
       "oidReset",
       "operationMetrics",
       "queryStatsRead",
       "queryStatsReadTransformed",
       "removeShard",
       "replSetConfigure",
       "replSetGetConfig",
       "replSetGetStatus",
       "replSetResizeOplog",
       "replSetStateChange",
       "resync",
       "rotateCertificates",
       "runTenantMigration",
       "serverStatus",
       "setClusterParameter",
       "setDefaultRWConcern",
       "setFeatureCompatibilityVersion",
       "setParameter",
       "setUserWriteBlockMode",
       "shardedDataDistribution",
       "shardingState",
       "shutdown",
       "top",
       "touch",
       "trafficRecord",
       "unlock",
       "useTenant",
       "useUUID",
       "viewUser",
       "applyOps"
      ]
     },
     {
      "resource": {
       "db": "",
       "collection": ""
      },
      "actions": [
       "bypassDocumentValidation",
       "changeCustomData",
       "changePassword",
       "changeStream",
       "clearJumboFlag",
       "collMod",
       "collStats",
       "compact",
       "compactStructuredEncryptionData",
       "convertToCapped",
       "createCollection",
       "createIndex",
       "createRole",
       "createSearchIndexes",
       "createUser",
       "dbHash",
       "dbStats",
       "dropCollection",
       "dropDatabase",
       "dropIndex",
       "dropSearchIndex",
       "dropRole",
       "dropUser",
       "enableProfiler",
       "enableSharding",
       "find",
       "getDatabaseVersion",
       "getShardVersion",
       "grantRole",
       "indexStats",
       "insert",
       "killCursors",
       "listCachedAndActiveUsers",
       "listCollections",
...
```
