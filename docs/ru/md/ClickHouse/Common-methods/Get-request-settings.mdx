---
sidebar_position: 3
description: Получить настройки запроса и другие функции для работы с ClickHouse в Открытом пакете интеграций - бесплатной open-source библиотеке интеграций для 1С:Предприятие 8, OneScript и CLI
keywords: [1C, 1С, 1С:Предприятие, 1С:Предприятие 8.3, API, Интеграция, Сервисы, Обмен, OneScript, CLI, ClickHouse]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Получить настройки запроса
 Формирует структуру описания запроса



`Функция ПолучитьНастройкиЗапроса(Знач Текст, Знач БазаДанных = Неопределено, Знач IDЗапроса = Неопределено, Знач Данные = Неопределено, Знач ФорматОтвета = "JSON", Знач ВнешниеТаблицы = Неопределено, Знач Настройки = Неопределено) Экспорт`

  | Параметр | CLI опция | Тип | Обяз. | Назначение |
  |-|-|-|-|-|
  | Текст | --query | Строка | &#x2714; | Текст запроса |
  | БазаДанных | --db | Строка | &#x2716; | База данных |
  | IDЗапроса | --id | Строка | &#x2716; | Уникальный ID запроса, если необходимо |
  | Данные | --data | Произвольный | &#x2716; | Строка, файл или двоичные данные запроса |
  | ФорматОтвета | --format | Строка | &#x2716; | Формат получения ответа: JSON, CSV, TSV и пр. |
  | ВнешниеТаблицы | --ext | Массив Из Структура | &#x2716; | Информация о внешних таблицах. См. [`ПолучитьСтруктуруВнешнейТаблицы`](/docs/ClickHouse/Common-methods/Get-external-table-structure) |
  | Настройки | --settings | Соответствие Из КлючИЗначение | &#x2716; | Дополнительные query параметры запроса |

  
  Возвращаемое значение:   Структура Из КлючИЗначение - Структура запроса

:::tip
При использовании транспорта `http` нельзя одновременно использовать `Данные` и `Внешние таблицы`

Тело ответа может быть возвращено в виде коллекции (для JSON) или в виде двоичных данных (для остальных форматов). В CLI версии двоичные данные будут представлены в виде Base64 строки
:::
<br/>


```bsl title="Пример использования для 1С:Предприятие/OneScript"
    // Минимальный запрос

    ТекстЗапроса = "SELECT 1";

    Результат = OPI_ClickHouse.ПолучитьНастройкиЗапроса(ТекстЗапроса);

    // Полный запрос

    IDЗапроса    = Строка(Новый УникальныйИдентификатор());
    Данные       = Новый Структура("meta,data", Новый Массив, Новый Массив);
    БазаДанных   = "default";
    ФорматОтвета = "CSV";

    ДопНастройки = Новый Соответствие;
    ДопНастройки.Вставить("max_threads", "4");

    СтруктураКолонок = Новый Структура("id,name", "UInt64", "String");
    ВнешняяТаблица   = OPI_ClickHouse.ПолучитьСтруктуруВнешнейТаблицы("ext", СтруктураКолонок);

    МассивТаблиц = Новый Массив;
    МассивТаблиц.Добавить(ВнешняяТаблица);

    Результат = OPI_ClickHouse.ПолучитьНастройкиЗапроса(ТекстЗапроса
        , БазаДанных
        , IDЗапроса
        , Данные
        , ФорматОтвета
        , МассивТаблиц
        , ДопНастройки);
```
    

 <Tabs>
  
    <TabItem value="bash" label="Bash" default>
        ```bash
            oint clickhouse ПолучитьНастройкиЗапроса \
              --query "SELECT * FROM events_stream_test ORDER BY id" \
              --format "JSON"
        ```
    </TabItem>
  
    <TabItem value="bat" label="CMD/Bat" default>
        ```batch
            oint clickhouse ПолучитьНастройкиЗапроса ^
              --query "SELECT * FROM events_stream_test ORDER BY id" ^
              --format "JSON"
        ```
    </TabItem>
</Tabs>


```json title="Результат"
{
 "query": "SELECT 1",
 "database": "default",
 "id": "24faa975-913e-4bd1-a6c4-150f864dbbd7",
 "data": "/tmp/zo2g1wki.ho3.json",
 "format": "CSV",
 "external_tables": [
  {
   "name": "ext",
   "cols": {
    "id": "UInt64",
    "name": "String"
   }
  }
 ],
 "settings": {
  "max_threads": "4"
 }
}
```
