---
id: Extensions
keywords: [1C, 1С, 1С:Предприятие, 1С:Предприятие 8.3, API, Интеграция, Сервисы, Обмен, OneScript, CLI]
title: Стандартная библиотека и расширения
sidebar_position: 4
---

В этом разделе описаны основные способы организации обработки входящих запросов: функциями из набора Открытого пакета интеграций и пользовательскими расширениями

## Методы ОПИ (стандартный набор)

Как уже рассматривалось в предыдущих подразделах документации, каждый обработчик харакетризуется функцией, отвечающей за формирование ответа на входящие запросы. По умолчанию, в Melezh встроен полный набор методов всех библиотек Открытого пакета интеграций. Эти методы могут быть выбраны в качестве функций обработки при настройке каждого конкретного обработчика

При настройке обработчиков в консольном режиме, для получения правильных имен библиотек (команд), функций и их аргументов можно воспользоваться документацией самого Открытого пакета интеграций

![Документация ОПИ](../../../../static/img/Docs/Melezh/3.png)

:::warning
Имена библиотек указываются в формет CLI приложения. Т.е. `telegram` или `gdrive` (Google Drive)
:::

<br/>

При работе в Web-консоли нужную библиотеку и функцию можно выбрать в выпадающем спике при настройке обработчика

![Web консоль](../../../../static/img/Docs/Melezh/4.png)

<hr/>

## Расширения

Помимо стандартного набора функций из набора ОПИ, в качестве функций-обработчиков Melezh можно использовать методы из произвольных `.os` скриптов. Для этого должно быть соблюдено три условия:

+ Метод должен быть функцией, возвращающей сериализуемую в JSON коллекцию: массив, структуру или соответствие без несериализуемых полей
+ Файл скрипта должен быть помещен в подкаталог `extensions/Modules` основного каталога Melezh:

Windows (стандартная установка из exe установщика):
```
C:\Program Files (x86)\OInt\share\oint\lib\melezh\extensions\Modules
```

Linux:
```
share/oint/lib/melezh/extensions/Modules
```

OneScript, в качестве OPM пакета:
```
<каталог OneScript>/lib/melezh/extensions/Modules
```

+ Метод должны иметь документриующий комментарий следующего вида:

```bsl
// Отображаемое имя метода
// Описание метода
//
// Параметры:
//  Поле1 - Строка  - Значение поля 1 - field1
//  Поле2 - Строка  - Значение поля 2 - field2
//  Поле3 - Строка  - Значение поля 3 - field3
//
// Возвращаемое значение:
//  Структура Из КлючИЗначение - возвращаемое значение
```

Это - стандартный формат комментария EDT, но с тремя отличительными особенностями: второй строкой является краткое описание функции, у параметров есть четверый блок описания - имя аргумента в CLI стиле, в описании параметра нельзя использовать знак `-` кроме как для разделения частей описания

:::warning
Использование `-` в тексте описания параметра приведет к ошибке 
:::

<br/>

В стандартной поставке, в каталоге `extensions/Modules` есть модуль `RequestsEcho.os`, который может быть использован в качестве шаблона для расширения:

```bsl title="RequestsEcho.os"

// Эхо полей
// Возвращает в ответе поля, отправленные в запросе
//
// Параметры:
//  Поле1 - Строка  - Значение поля 1 - field1
//  Поле2 - Строка  - Значение поля 2 - field2
//  Поле3 - Строка  - Значение поля 3 - field3
//
// Возвращаемое значение:
//  Структура Из КлючИЗначение - Эхо
Функция ЭхоПолей(Знач Поле1, Знач Поле2, Знач Поле3 = "") Экспорт
	Возврат Новый Структура("field1,field2,field3", Поле1, Поле2, Поле3);
КонецФункции

```

В списке выбора Web-консоли данный модуль будет отображен следующим образом

![RequestsEcho](../../../../static/img/Docs/Melezh/5.png)


:::tip
Рекомендуется дополнительно сохранять копии модулей расширений в другом месте, так как в отдельных случаях обновления и удаления Melezh, а также при пересборке образа (если используется Docker), 
:::

