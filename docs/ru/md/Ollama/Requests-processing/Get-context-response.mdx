---
sidebar_position: 3
description: Получить ответ в контексте и другие функции для работы с Ollama в Открытом пакете интеграций - бесплатной open-source библиотеке интеграций для 1С:Предприятие 8, OneScript и CLI
keywords: [1C, 1С, 1С:Предприятие, 1С:Предприятие 8.3, API, Интеграция, Сервисы, Обмен, OneScript, CLI, Ollama]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Получить ответ в контексте
 Получает очередной ответ от модели в соответствии с историей сообщений



`Функция ПолучитьОтветВКонтексте(Знач URL, Знач Модель, Знач Сообщения, Знач ДопПараметры = "", Знач ДопЗаголовки = "") Экспорт`

  | Параметр | CLI опция | Тип | Обяз. | Назначение |
  |-|-|-|-|-|
  | URL | --url | Строка | &#x2714; | URL сервера Ollama |
  | Модель | --model | Строка | &#x2714; | Имя модели |
  | Сообщения | --msgs | Массив Из Структура | &#x2714; | История сообщений. См. ПолучитьСтруктуруСообщенияКонтекста |
  | ДопПараметры | --options | Структура Из КлючИЗначение | &#x2716; | Доп. параметры. См. ПолучитьСтруктуруПараметровЗапроса |
  | ДопЗаголовки | --headers | Соответствие Из КлючИЗначение | &#x2716; | Доп заголовки запроса, если необходимо |

  
  Возвращаемое значение:   Соответствие Из КлючИЗначение - Результат обработки

<br/>

:::tip
Метод в документации API: [Generate a chat completion](https://github.com/ollama/ollama/blob/main/docs/api.md#generate-a-chat-completion)
:::
<br/>



```bsl title="Пример использования для 1С:Предприятие/OneScript"
    URL   = "https://hut.openintegrations.dev/ollama";
    Токен = "12We34..."; // Авторизация - не часть API Ollama

    ДопЗаголовки = Новый Соответствие;
    ДопЗаголовки.Вставить("Authorization", СтрШаблон("Bearer %1", Токен));

    Модель = "tinyllama";

    МассивСообщений = Новый Массив;

    Вопрос1 = OPI_Ollama.ПолучитьСтруктуруСообщенияКонтекста("user", "What is 1C:Enterprise?");
    Вопрос2 = OPI_Ollama.ПолучитьСтруктуруСообщенияКонтекста("user", "When the first version was released?"); // Вопрос без конкретики

    // Добавляем первый вопрос в контекст
    МассивСообщений.Добавить(Вопрос1);

    Ответ1 = OPI_Ollama.ПолучитьОтветВКонтексте(URL, Модель, МассивСообщений, , ДопЗаголовки);

    МассивСообщений.Добавить(Ответ1["message"]); // Добавляем ответ на первый вопрос в контекст
    МассивСообщений.Добавить(Вопрос2);           // Добавляем второй вопрос в контекст

    Ответ2 = OPI_Ollama.ПолучитьОтветВКонтексте(URL, Модель, МассивСообщений, , ДопЗаголовки);

    МассивСообщений.Добавить(Ответ2["message"]);

    // ...
```
    

 <Tabs>
  
    <TabItem value="bash" label="Bash" default>
        ```bash
            oint ollama ПолучитьОтветВКонтексте \
              --url ""https://hut.openintegrations.dev/ollama"" \
              --model ""tinyllama"" \
              --msgs ""[{'role':'user','content':'Hello!'}]"" \
              --options ""/tmp/52lzxfkr.5cl.json"" \
              --headers "{'Authorization':'***'}"
        ```
    </TabItem>
  
    <TabItem value="bat" label="CMD/Bat" default>
        ```batch
            oint ollama ПолучитьОтветВКонтексте ^
              --url ""https://hut.openintegrations.dev/ollama"" ^
              --model ""tinyllama"" ^
              --msgs ""[{'role':'user','content':'Hello!'}]"" ^
              --options ""/tmp/52lzxfkr.5cl.json"" ^
              --headers "{'Authorization':'***'}"
        ```
    </TabItem>
</Tabs>


```json title="Результат"
{
 "model": "tinyllama",
 "created_at": "2025-09-10T19:02:29.594970586Z",
 "message": {
  "role": "assistant",
  "content": "The first version of 1C:Enterprise was released in 1998. The software continued to be updated and enhanced over time, as new features and improvements were developed. The latest version, which is currently available, is called 1C:Cloud Enterprise, and it was launched in late 2020 or early 2021 based on the latest technology advancements. In fact, some of the key features and updates introduced to the software in the latest version include:\n\n1. Improved security measures: The latest version of 1C:Cloud Enterprise comes with robust security features such as end-to-end encryption, multi-factor authentication (MFA), and data protection policies.\n\n2. New integration capabilities: 1C:Cloud Enterprise now supports various cloud platforms such as Amazon Web Services (AWS), Microsoft Azure, Google Cloud Platform (GCP), and more. This makes it easier for SMEs to access the software's functionality on a variety of devices and platforms.\n\n3. Streamlined user experience: 1C:Cloud Enterprise has been redesigned with a modern and streamlined interface that's easy to navigate, making it more accessible to users of all skill levels.\n\n4. Increased functionality: The latest version includes new features such as digital signatures, electronic invoicing, and more. These enhancements ensure the software supports today's business requirements for faster and easier processing."
 },
 "done_reason": "stop",
 "done": true,
 "total_duration": 32553761309,
 "load_duration": 14169210,
 "prompt_eval_count": 198,
 "prompt_eval_duration": 4800111667,
 "eval_count": 313,
 "eval_duration": 27735297723
}
```
