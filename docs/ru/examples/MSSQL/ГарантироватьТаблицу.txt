    Адрес  = "127.0.0.1";
    Логин  = "SA";
    Пароль = "12we...";

    База    = "testbase1";
    Таблица = "testtable";

    Опции = Новый Структура;
    Опции.Вставить("trust", Истина);

    НастройкиTLS = OPI_ПолучениеДанныхТестов.ВыполнитьТестCLI("mssql", "ПолучитьНастройкиTLS", Опции);
    Опции        = Новый Структура;
    Опции.Вставить("addr" , Адрес);
    Опции.Вставить("db"   , База);
    Опции.Вставить("login", Логин);
    Опции.Вставить("pass" , Пароль);

    СтрокаПодключения = OPI_ПолучениеДанныхТестов.ВыполнитьТестCLI("mssql", "СформироватьСтрокуПодключения", Опции);

    СтруктураКолонок = Новый Структура;
    СтруктураКолонок.Вставить("smallint_field" , "smallint");
    СтруктураКолонок.Вставить("double_field"   , "real");
    СтруктураКолонок.Вставить("bigint_field"   , "bigint");
    СтруктураКолонок.Вставить("custom_field"   , "nvarchar");

    // При использовании строки подключения инициализируется новое соединение,
    // которое будет закрыто после выполнения функции.
    // В случае выполнения нескольких операций желательно использовать одно соединение,
    // заранее созданное функцией ОткрытьСоединение()
    Опции = Новый Структура;
    Опции.Вставить("table", Таблица);
    Опции.Вставить("cols", СтруктураКолонок);
    Опции.Вставить("dbc", СтрокаПодключения);
    Опции.Вставить("tls", НастройкиTLS);

    Результат = OPI_ПолучениеДанныхТестов.ВыполнитьТестCLI("mssql", "ГарантироватьТаблицу", Опции);