    Адрес  = "127.0.0.1:1234";
    Логин  = "bayselonarrend";
    Пароль = "12we...";
    База   = "main";

    ПараметрыПодключения = Новый Структура("authSource", "admin");
    СтрокаПодключения    = OPI_MongoDB.СформироватьСтрокуПодключения(Адрес, , Логин, Пароль, ПараметрыПодключения);
    Соединение           = OPI_MongoDB.ОткрытьСоединение(СтрокаПодключения);

    Коллекция = "new_collection";

    Фильтр     = Новый Структура("stringField", "Текст");
    Сортировка = Новый Структура("doubleField", -1);
    Параметры  = Новый Структура("limit,batchSize", 2, 1);

    Курсор = OPI_MongoDB.ПолучитьКурсор(Соединение, Коллекция, База, Фильтр, Сортировка, Параметры);

    Если Не Курсор["result"] Тогда
        ВызватьИсключение Курсор["error"];
    КонецЕсли;

    Курсор            = Курсор["data"]["cursor"];
    МассивДокументов  = Курсор["firstBatch"];
    IDКурсора         = Курсор["id"];
    ПродолжатьВыборку = IDКурсора > 0;

    Пока ПродолжатьВыборку Цикл

        Результат = OPI_MongoDB.ПолучитьПакетДокументов(Соединение, Коллекция, IDКурсора, База); // <---

        Если Не Результат["result"] Тогда
            ВызватьИсключение Результат["error"];
        КонецЕсли;

        ПродолжатьВыборку = Результат["data"]["cursor"]["id"] > 0;

        Для Каждого Запись Из Результат["data"]["cursor"]["nextBatch"] Цикл
            МассивДокументов.Добавить(Запись);
        КонецЦикла;

    КонецЦикла;
