    // -- Тестовый запрос для сервера

    КлючКлиента = Новый УникальныйИдентификатор;
    Сообщение   = "Тестовая отправка данных на сервер";

    ПараметрыКлиента = Новый Массив;
    ПараметрыКлиента.Добавить("127.0.0.1:7788"); // Наш сервер
    ПараметрыКлиента.Добавить(Сообщение);        // Тестовая строка
    ПараметрыКлиента.Добавить("UTF-8");          // Кодировка
    ПараметрыКлиента.Добавить("20000");          // Таймаут, чтобы успеть запустить сервер

    // Отправка тестового запроса через клиентские методы TCP
    ФоновоеКлиента = ФоновыеЗадания.Выполнить("OPI_TCP.ОтправитьСтроку", ПараметрыКлиента, КлючКлиента);

    // --

    TCPСервер = OPI_TCP.СоздатьСервер(7788, Истина);

    НовоеПодключение = OPI_TCP.ОжидатьВходящиеСоединения(TCPСервер, 20);

    Если НовоеПодключение["result"] Тогда

        Подключение = НовоеПодключение["connection"]["id"];

        МассивПараметровОбработки = Новый Массив;
        МассивПараметровОбработки.Добавить(Подключение); // Строка: "1:7788"

        ФоновоеОбработки = ФоновыеЗадания.Выполнить("OPI_Тесты.TCP_ОбработатьПодключение", МассивПараметровОбработки);

        TCP_ОбработатьПодключение(Подключение);

    КонецЕсли;

    Отключение = OPI_TCP.ОтключитьСервер(TCPСервер);
