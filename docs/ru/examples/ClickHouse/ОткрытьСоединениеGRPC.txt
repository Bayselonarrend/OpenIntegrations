    URL = "http://localhost:9101";

    Логин  = "bayselonarrend";
    Пароль = "12we...";

    Авторизация = Новый Структура(Логин, Пароль);

    НастройкиСоединения = OPI_ClickHouse.ПолучитьНастройкиСоединенияGRPC(URL, Авторизация);
    Соединение          = OPI_ClickHouse.ОткрытьСоединениеGRPC(НастройкиСоединения);

    // Запрос (простой)

    ТекстЗапроса = "CREATE TABLE events (
    |    id UInt64,
    |    timestamp DateTime,
    |    user_id UInt32,
    |    event_type String,
    |    payload String
    |) ENGINE    = MergeTree()
    |ORDER BY (timestamp, id)";

    Запрос    = OPI_ClickHouse.ПолучитьНастройкиЗапроса(ТекстЗапроса);
    Результат = OPI_ClickHouse.ВыполнитьЗапрос(Соединение, Запрос);

    // Запрос (с данными)

    ТекстЗапроса = "INSERT INTO events FORMAT JSON";

    ФорматДанных = "JSON";
    МассивДанных = Новый Массив;

    ТекущаяДата = OPI_Инструменты.ПолучитьТекущуюДату();

    Запись1 = Новый Структура;
    Запись1.Вставить("id"        , 1);
    Запись1.Вставить("timestamp" , ТекущаяДата);
    Запись1.Вставить("user_id"   , 100);
    Запись1.Вставить("event_type", "click");
    Запись1.Вставить("payload"   , "{}");

    Запись2 = Новый Структура;
    Запись2.Вставить("id"        , 2);
    Запись2.Вставить("timestamp" , ТекущаяДата);
    Запись2.Вставить("user_id"   , 200);
    Запись2.Вставить("event_type", "hover");
    Запись2.Вставить("payload"   , "{}");

    МассивДанных.Добавить(Запись1);
    МассивДанных.Добавить(Запись2);

    Мета = Новый Массив;
    Мета.Добавить(Новый Структура("name,type", "id"        , "UInt64"));
    Мета.Добавить(Новый Структура("name,type", "timestamp" , "DateTime"));
    Мета.Добавить(Новый Структура("name,type", "user_id"   , "UInt32"));
    Мета.Добавить(Новый Структура("name,type", "event_type", "String"));
    Мета.Добавить(Новый Структура("name,type", "payload"   , "String"));

    Данные     = Новый Структура("meta,data", Мета, МассивДанных);
    БазаДанных = "default";
    IDЗапроса  = Строка(Новый УникальныйИдентификатор());

    Запрос    = OPI_ClickHouse.ПолучитьНастройкиЗапроса(ТекстЗапроса, БазаДанных, IDЗапроса, Данные, ФорматДанных);
    Результат = OPI_ClickHouse.ВыполнитьЗапрос(Соединение, Запрос);
