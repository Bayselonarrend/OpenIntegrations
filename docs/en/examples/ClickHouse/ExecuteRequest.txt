    // Connection settings

    URL = "http://localhost:8123";
    Login    = "bayselonarrend";
    Password = "12we...";

    Authorization = New Structure(Login, Password);

    Options = New Structure;
    Options.Insert("url" , URL);
    Options.Insert("auth", Authorization);

    Connection = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "GetHTTPConnectionSettings", Options);

    // Request (table creation)

    QueryText = "CREATE TABLE IF NOT EXISTS events (
    |    id UInt64,
    |    timestamp DateTime,
    |    user_id UInt32,
    |    event_type String,
    |    payload String
    |) ENGINE = MergeTree()
    |ORDER BY (timestamp, id)";

    Options = New Structure;
    Options.Insert("query", QueryText);

    Request = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "GetRequestSettings", Options);
    Options = New Structure;
    Options.Insert("conn", Connection);
    Options.Insert("req" , Request);

    Result = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "ExecuteRequest", Options);

    // Request (data insertion)

    QueryText = "INSERT INTO events FORMAT JSON";

    DataFormat = "JSON";
    DataArray  = New Array;

    CurrentDate = Date("20260101100000");

    Record1 = New Structure;
    Record1.Insert("id"        , 1);
    Record1.Insert("timestamp" , CurrentDate);
    Record1.Insert("user_id"   , 100);
    Record1.Insert("event_type", "click");
    Record1.Insert("payload"   , "{}");

    Record2 = New Structure;
    Record2.Insert("id"        , 2);
    Record2.Insert("timestamp" , CurrentDate);
    Record2.Insert("user_id"   , 200);
    Record2.Insert("event_type", "hover");
    Record2.Insert("payload"   , "{}");

    DataArray.Add(Record1);
    DataArray.Add(Record2);

    Meta = New Array;
    Meta.Add(New Structure("name,type", "id"        , "UInt64"));
    Meta.Add(New Structure("name,type", "timestamp" , "DateTime"));
    Meta.Add(New Structure("name,type", "user_id"   , "UInt32"));
    Meta.Add(New Structure("name,type", "event_type", "String"));
    Meta.Add(New Structure("name,type", "payload"   , "String"));

    Data      = New Structure("meta,data", Meta, DataArray);
    Database  = "default";
    RequestID = String(New UUID());

    Options = New Structure;
    Options.Insert("query" , QueryText);
    Options.Insert("db"    , Database);
    Options.Insert("id"    , RequestID);
    Options.Insert("data"  , Data);
    Options.Insert("format", DataFormat);

    Request = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "GetRequestSettings", Options);
    Options = New Structure;
    Options.Insert("conn", Connection);
    Options.Insert("req" , Request);

    Result = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "ExecuteRequest", Options);

    // Request with external table

    TableName      = "ext_users";
    ColoumnsStruct = New Structure;
    ColoumnsStruct.Insert("id"  , "UInt64");
    ColoumnsStruct.Insert("name", "String");

    Tab       = Chars.Tab;
    TableData = "1" + Tab + "John
    |2" + Tab + "Jane
    |3" + Tab + "Bob";

    Options = New Structure;
    Options.Insert("name"  , TableName);
    Options.Insert("cols"  , ColoumnsStruct);
    Options.Insert("data"  , TableData);
    Options.Insert("format", "TSV");

    ExternalTable = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "GetExternalTableStructure", Options);

    ExternalTablesArray = New Array;
    ExternalTablesArray.Add(ExternalTable);

    QueryText = "SELECT * FROM ext_users WHERE id > 1";

    Options = New Structure;
    Options.Insert("query" , QueryText);
    Options.Insert("format", "JSON");
    Options.Insert("ext"   , ExternalTablesArray);

    Request = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "GetRequestSettings", Options);
    Options = New Structure;
    Options.Insert("conn", Connection);
    Options.Insert("req" , Request);

    Result = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "ExecuteRequest", Options);

    // Selection

    SelectionText = "SELECT * FROM events";

    Options = New Structure;
    Options.Insert("query" , SelectionText);
    Options.Insert("format", "JSON");

    Request = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "GetRequestSettings", Options);
    Options = New Structure;
    Options.Insert("conn", Connection);
    Options.Insert("req" , Request);

    Result = OPI_TestDataRetrieval.ExecuteTestCLI("clickhouse", "ExecuteRequest", Options);