---
sidebar_position: 9
description: Process GRPC sending and other functions to work with ClickHouse in the Open Integration Package, a free open-source integration library for 1C:Enterprise 8, OneScript and CLI
keywords: [1C, 1ะก, 1ะก:Enterprise, 1ะก:Enterprise 8.3, API, Integration, Services, Exchange, OneScript, CLI, ClickHouse]
---

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Process GRPC sending
 Initializes the stream, sends the request and a set of data in a specified order, receiving one message upon completion



`Function ProcessGRPCSending(Val Connection, Val Request, Val Data, Val Session = Undefined, Val Timeout = 10000) Export`

  | Parameter | CLI option | Type | Required | Description |
  |-|-|-|-|-|
  | Connection | --conn | Arbitrary | &#x2714; | Existing connection or connection parameters |
  | Request | --req | Structure Of KeyAndValue | &#x2714; | Request data. See GetRequestSettings |
  | Data | --data | Array Of Arbitrary | &#x2714; | An array of strings, collections, binary data, or file paths |
  | Session | --session | Structure Of KeyAndValue | &#x2716; | Session settings. See GetSessionSettings |
  | Timeout | --tout | Number | &#x2716; | Timeout (in ms) |

  
  Returns:  Map Of KeyAndValue - Processing result



```bsl title="1C:Enterprise/OneScript code example"
    URL = "http://localhost:9101";
    Login    = "bayselonarrend";
    Password = "12we...";

    Authorization      = New Structure(Login, Password);
    ConnectionSettings = OPI_ClickHouse.GetGRPCConnectionSettings(URL, Authorization);
    Connection         = OPI_ClickHouse.CreateGRPCConnection(ConnectionSettings);

    QueryText   = "INSERT INTO events_stream_test FORMAT JSONEachRow";
    DataFormat  = "JSON";
    CurrentDate = Date("20260101100000");

    Request   = Undefined;
    DataArray = New Array;

    Counter = 0;
    While Counter < 5 Do

        Record = New Structure;
        Record.Insert("id"        , Counter + 1);
        Record.Insert("timestamp" , CurrentDate);
        Record.Insert("user_id"   , 100 + Counter);
        Record.Insert("event_type", "stream_test");
        Record.Insert("payload"   , "{}");

        Record = OPI_Tools.JSONString(Record) + Chars.LF;

        If Counter  = 0 Then
            Request = OPI_ClickHouse.GetRequestSettings(QueryText, "default", , Record, DataFormat);
        Else
            DataArray.Add(Record);
        EndIf;

        Counter = Counter + 1;

    EndDo;

    Result = OPI_ClickHouse.ProcessGRPCSending(Connection, Request, DataArray);
```
 

 <Tabs>
  
    <TabItem value="bash" label="Bash" default>
        ```bash
            # JSON data can also be passed as a path to a .json file
            
            oint clickhouse ProcessGRPCSending \
              --conn "{'address':'http://127.0.0.1:9101','transport':'grpc','auth_type':'basic','user':'bayselonarrend','password':'***'}" \
              --req "{'query':'INSERT INTO events_stream_test FORMAT JSONEachRow','database':'default','data':{'id':'1','timestamp':'1/1/2026 10:00:00 AM','user_id':'100','event_type':'stream_test','payload':'{}'},'format':'JSON'}" \
              --data "[{'id':'2','timestamp':'1/1/2026 10:00:00 AM','user_id':'101','event_type':'stream_test','payload':'{}'},{'id':'3','timestamp':'1/1/2026 10:00:00 AM','user_id':'102','event_type':'stream_test','payload':'{}'},{'id':'4','timestamp':'1/1/2026 10:00:00 AM','user_id':'103','event_type':'stream_test','payload':'{}'},{'id':'5','timestamp':'1/1/2026 10:00:00 AM','user_id':'104','event_type':'stream_test','payload':'{}'}]"
        ```
    </TabItem>
  
    <TabItem value="bat" label="CMD/Bat" default>
        ```batch
            :: JSON data can also be passed as a path to a .json file
            
            oint clickhouse ProcessGRPCSending ^
              --conn "{'address':'http://127.0.0.1:9101','transport':'grpc','auth_type':'basic','user':'bayselonarrend','password':'***'}" ^
              --req "{'query':'INSERT INTO events_stream_test FORMAT JSONEachRow','database':'default','data':{'id':'1','timestamp':'1/1/2026 10:00:00 AM','user_id':'100','event_type':'stream_test','payload':'{}'},'format':'JSON'}" ^
              --data "[{'id':'2','timestamp':'1/1/2026 10:00:00 AM','user_id':'101','event_type':'stream_test','payload':'{}'},{'id':'3','timestamp':'1/1/2026 10:00:00 AM','user_id':'102','event_type':'stream_test','payload':'{}'},{'id':'4','timestamp':'1/1/2026 10:00:00 AM','user_id':'103','event_type':'stream_test','payload':'{}'},{'id':'5','timestamp':'1/1/2026 10:00:00 AM','user_id':'104','event_type':'stream_test','payload':'{}'}]"
        ```
    </TabItem>
</Tabs>


```json title="Result"
{
 "result": true,
 "request_sending": {
  "result": true
 },
 "data_sending": [
  {
   "result": true
  },
  {
   "result": true
  },
  {
   "result": true
  },
  {
   "result": true
  }
 ],
 "received_message": {
  "message": {
   "cancelled": false,
   "exception": {
    "code": 0,
    "display_text": "",
    "name": "",
    "stack_trace": ""
   },
   "extremes": {
    "BYTES": ""
   },
   "logs": [],
   "output": {
    "BYTES": ""
   },
   "output_columns": [],
   "output_format": "",
   "progress": {
    "read_bytes": 0,
    "read_rows": 0,
    "total_rows_to_read": 0,
    "written_bytes": 235,
    "written_rows": 5
   },
   "query_id": "fd38cfa1-9f6b-4765-93c3-08e880f242f4",
   "stats": {
    "allocated_bytes": 0,
    "applied_aggregation": false,
    "applied_limit": false,
    "blocks": 0,
    "rows": 0,
    "rows_before_aggregation": 0,
    "rows_before_limit": 0
   },
   "time_zone": "Europe/Moscow",
   "totals": {
    "BYTES": ""
   }
  },
  "result": true
 },
 "stream_closing": {
  "result": true
 }
}
```
